## Threads 抽獎程式：使用與安裝指南

這個程式能幫助你從 Threads 貼文留言中，自動抓取不重複的留言者帳號，並進行隨機抽獎。

-----

### 一、程式功能概覽

  * **自動化登入引導**：引導你手動登入 Threads。
  * **智能滾動抓取**：自動滾動頁面，抓取所有留言。
  * **留言去重複**：確保每個留言內容只計算一次，避免重複計數。
  * **帳號去重複**：自動排除發文作者本人，並確保每個參與抽獎的帳號都是獨立的，即使同一個人留多則留言也只算一次。
  * **互動式抽獎**：透過彈出視窗讓你輸入抽獎人數，並顯示中獎名單。
  * **錯誤處理**：若程式執行中斷，會自動截圖保存。

-----

### 二、環境安裝需求

在執行程式之前，你需要安裝 Python 及相關的套件。

1.  **安裝 Python**

      * **下載**：前往 [Python 官方網站](https://www.python.org/downloads/) 下載最新版本的 Python 3。
      * **安裝**：執行安裝程式時，**務必勾選「Add Python to PATH」** 選項，這樣可以讓你直接在命令提示字元（或終端機）中使用 Python 指令。

2.  **安裝所需 Python 套件**
    開啟你的命令提示字元（Windows: 搜尋 `cmd` 或 `PowerShell` / macOS/Linux: 搜尋 `Terminal`），然後依序輸入以下指令並執行：

    ```bash
    pip install selenium
    pip install webdriver-manager
    pip install beautifulsoup4 # 雖然程式碼中未使用，但建議安裝以備未來擴展
    pip install tk # 通常 Python 安裝時會內建，但若有錯誤可嘗試重新安裝
    ```

      * **`selenium`**: 用於網頁自動化操作。
      * **`webdriver-manager`**: 自動下載並管理與你 Chrome 瀏覽器版本相符的 WebDriver。
      * **`beautifulsoup4`**: 雖然你的程式目前沒有用到，但這是網頁解析常用的套件，安裝起來以防萬一或未來功能擴展。
      * **`tk`**: Python 內建的 GUI 庫，用於顯示彈出視窗（例如輸入網址和顯示抽獎結果）。

3.  **安裝 Google Chrome 瀏覽器**
    確保你的電腦上安裝了 Google Chrome 瀏覽器，因為本程式是基於 Chrome 進行自動化操作的。

-----

### 三、程式使用步驟

1.  **儲存程式碼**
    將這份 Python 程式碼儲存為一個 `.py` 檔案，例如命名為 `threads_lottery.py`。

2.  **開啟命令提示字元/終端機**
    進入你儲存 `threads_lottery.py` 檔案的資料夾路徑。

      * **Windows**：在資料夾中按住 `Shift` 鍵，然後點擊滑鼠右鍵，選擇「在此處開啟 PowerShell 視窗」或「在此處開啟命令視窗」。
      * **macOS/Linux**：開啟終端機，使用 `cd` 命令切換到檔案所在的資料夾。例如：`cd ~/Downloads`

3.  **執行程式**
    在命令提示字元（或終端機）中輸入以下指令並執行：

    ```bash
    python threads_lottery.py
    ```

4.  **依照指示操作**
    程式執行後，會彈出視窗或在命令列提示你進行以下操作：

      * **手動登入 Threads**：程式會自動開啟 Chrome 瀏覽器並導航到 Threads 登入頁面。請你**手動完成登入**，然後回到命令提示字元視窗，按下 `Enter` 鍵繼續。
      * **輸入 Threads 貼文網址**：會彈出一個對話框，請你在這裡貼上你想要抽獎的 **Threads 貼文完整網址**，然後點擊「OK」。
      * **等待程式抓取留言**：程式會自動滾動頁面並抓取留言。這個過程可能需要一些時間，具體取決於留言的數量。請耐心等待，過程中你可以在命令列看到留言抓取的進度（不重複留言總數和帳號數）。
      * **輸入抽獎人數**：留言抓取完成後，會彈出另一個對話框，顯示總共有多少個不重複的留言帳號，並請你輸入要抽出的人數。
      * **查看抽獎結果**：最後，程式會彈出一個視窗，顯示恭喜中獎者的名單。

5.  **結束程式**
    抽獎結果顯示完畢後，回到命令提示字元視窗，按下 `Enter` 鍵即可關閉瀏覽器並結束程式。

-----

### 四、注意事項

  * **網路連線**：確保你的網路連線穩定。
  * **瀏覽器更新**：請保持你的 Google Chrome 瀏覽器為最新版本，這樣 `webdriver-manager` 才能正確地找到並下載相容的 WebDriver。
  * **程式中斷**：如果在抓取留言過程中程式意外中斷，它會嘗試截圖保存錯誤畫面。
  * **Threads 介面變更**：Threads 網站的 HTML 結構可能會不定期更新。如果未來程式無法正常抓取留言，可能是因為網站介面變更導致 XPath 失效，這需要修改程式碼中的 `By.XPATH` 部分。

希望這份指南對你有幫助！
